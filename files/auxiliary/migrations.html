<!DOCTYPE html><html><head><meta charset="utf-8"><title>Migrations - Auxiliary Docs | Factorio</title><link href="https://cdn.factorio.com/assets/fonts/titillium-web.css" rel="stylesheet"><link href="https://cdn.factorio.com/assets/fonts/roboto-mono.css" rel="stylesheet"><link href="../style.css?v=72ae9920" rel="stylesheet" type="text/css"><meta name="viewport" content="width=device-width"><link rel="shortcut icon" href="../static/favicon.png"><script src="../script.js?v=72ae9920"></script></head><body class="docs docs-wide"><div id="top" class="top-bar mb32"><div class="top-bar-inner"><div class="sites links flex flex-items-baseline" style="width: 100%"><span><a href="https://factorio.com" style="color: #7dcaed;">Factorio.com</a><span class="separator">|</span><a href="https://forums.factorio.com/" style="color: #7dcaed;">Forums</a><span class="separator">|</span><a href="https://wiki.factorio.com/" style="color: #7dcaed;">Wiki</a><span class="separator">|</span><a href="https://mods.factorio.com" style="color: #7dcaed;">Mod Portal</a><span class="separator">|</span><a href="../index.html" class="sites-current">API Docs</a></span><span style="margin-left: auto;"><a href="../index-prototype.html">Prototype</a><span class="separator">|</span><a href="../index-runtime.html">Runtime</a><span class="separator">|</span><a href="../index-auxiliary.html" class="sites-current">Auxiliary</a></span></div></div></div><div class="container"><div class="container-inner"><div id="auxiliary-page"></div> <h1 class="ml8 mr8" style="position: relative;"><a href="../index-auxiliary.html" style="color: #ffe6c0;">Factorio Auxiliary Docs</a><a href="/" class="version-link" style="color: #ffe6c0;"><span class="version-string">Version</span> 2.0.55 <img src="../static/collapse-symbol.png" class="collapse-icon"></a></h1><div id="docs-layout-panel" class="panel flex-column pb0 overflow-unset"><div class="flex flex-reverse docs-panes " style="margin-top: -12px;"><div class="docs-content flex flex-column"><div class="panel-inset breadcrumbs mb0 p4"><span class="breadcrumbs-text"><a href="../index-auxiliary.html">Home</a> / <a href="migrations.html">Migrations</a></span><a id="page-width-button" class="button square-sm" style="float: right;">&gt;&lt;</a></div><div class="panel-inset-lighter" style="flex-grow: 1;"><h2 id="migrations">Migrations<a class="ml8 link" href="#migrations"><img src="../static/link-symbol.png"></a></h2><p>Migrations are a way to fix up a save file which was used in an older version of the game or mod. They have to be either <code>.lua</code> or <code>.json</code> files in the mod's <code>"migrations"</code> folder, depending on their purpose. They are typically used to change the type of a prototype or correct research and recipe states after changes.</p><p>The sequence in which migrations are executed is sorted by mod order first, migration file name second (using <a href="http://en.cppreference.com/w/cpp/algorithm/lexicographical_compare">lexicographical comparison</a>). All JSON migrations are applied before any Lua migrations. Each save file remembers (by name) which migrations from which mods have been applied and will not apply the same migration twice. When adding a mod to an existing save, all migration scripts for that mod will be run.</p><h3 id="json-migrations">JSON migrations<a class="ml8 link" href="#json-migrations"><img src="../static/link-symbol.png"></a></h3><p>JSON migrations allow changing one prototype into another. This is typically used to rename a prototype. Note that when an entity prototype's name is changed, it retains its previous <a href="../classes/LuaEntity.html#unit_number">unit_number</a> and any references to it saved in <a href="storage.html">storage</a> stay valid. Changing an entity's type will however result in a new <code>unit_number</code> and an invalid reference in <code>storage</code>.</p><p>Ghost entities are not always able to be migrated, in which case they are removed instead. Reasons for this include a change in the type of the entity, or the entity becoming unbuildable.</p><p>JSON migrations are applied as a map is being loaded. Multiple such migrations can be applied at once. All JSON migrations are applied before any Lua migrations.</p><h4 id="json-example">JSON Example<a class="ml8 link" href="#json-example"><img src="../static/link-symbol.png"></a></h4><p>The <code>"wall"</code> entity and item being renamed to <code>"stone-wall"</code>:</p><div class="codehilite" style="background: #263238"><pre style="line-height: 125%;"><span></span><code><span style="color: #89DDFF">{</span>
<span style="color: #EFF">  </span><span style="color: #C3E88D">&quot;entity&quot;</span><span style="color: #89DDFF">:</span>
<span style="color: #EFF">  </span><span style="color: #89DDFF">[</span>
<span style="color: #EFF">    </span><span style="color: #89DDFF">[</span><span style="color: #C3E88D">&quot;wall&quot;</span><span style="color: #89DDFF">,</span><span style="color: #EFF"> </span><span style="color: #C3E88D">&quot;stone-wall&quot;</span><span style="color: #89DDFF">]</span>
<span style="color: #EFF">  </span><span style="color: #89DDFF">],</span>
<span style="color: #EFF">  </span><span style="color: #C3E88D">&quot;item&quot;</span><span style="color: #89DDFF">:</span>
<span style="color: #EFF">  </span><span style="color: #89DDFF">[</span>
<span style="color: #EFF">    </span><span style="color: #89DDFF">[</span><span style="color: #C3E88D">&quot;wall&quot;</span><span style="color: #89DDFF">,</span><span style="color: #EFF"> </span><span style="color: #C3E88D">&quot;stone-wall&quot;</span><span style="color: #89DDFF">]</span>
<span style="color: #EFF">  </span><span style="color: #89DDFF">]</span>
<span style="color: #89DDFF">}</span>
</code></pre></div><h4 id="available-for-migration">Available for migration<a class="ml8 link" href="#available-for-migration"><img src="../static/link-symbol.png"></a></h4><p>The following prototype types are available for migration:</p><ul><li>"custom-input"</li><li>"equipment-grid"</li><li>"entity"</li><li>"item"</li><li>"tile"</li><li>"decorative"</li><li>"recipe-category"</li><li>"item-group"</li><li>"item-subgroup"</li><li>"recipe"</li><li>"fluid"</li><li>"ammo-category"</li><li>"fuel-category"</li><li>"resource-category"</li><li>"technology"</li><li>"noise-layer"</li><li>"noise-expression"</li><li>"autoplace-control"</li><li>"equipment"</li><li>"damage-type"</li><li>"virtual-signal"</li><li>"achievement"</li><li>"module-category"</li><li>"equipment-category"</li><li>"mod-setting"</li><li>"trivial-smoke"</li><li>"shortcut"</li></ul><h3 id="lua-migrations">Lua migrations<a class="ml8 link" href="#lua-migrations"><img src="../static/link-symbol.png"></a></h3><p>Lua migrations allow altering the loaded game state before it starts running. The global <a href="../classes/LuaGameScript.html">game</a> object is available in Lua migrations, which is how the game state can be modified.</p><p>The game resets <a href="../classes/LuaForce.html#reset_recipes">recipes</a> and <a href="../classes/LuaForce.html#reset_technologies">technologies</a> any time mods, prototypes, or startup settings change, so this does not need to be done by migration scripts anymore.</p> </div></div><div class="docs-sidebar mr12 flex-column fs0"><div class="panel-inset breadcrumbs mb0 p4"><span class="breadcrumbs-text"><a href="../defines.html" class="category-link" data-view="list-defines">Defines</a></span><a id="hide-sidebar-button" class="button square-sm" style="float: right;">|&lt;</a></div><div class="panel-inset mb0 fs0 p4 flex"><input id="ref-search" type="text" class="w100p" placeholder="Search..." spellcheck="false"></div><div id="docs-sidebar-list" class="panel-inset-lighter mt0 p2 docs-sidebar-list h100"><h2 class="ml8 mt8 mb0 yellow">General Topics</h2><ul class="panel-hole" id="list-general"><li data-name="Data Lifecycle"><a href="data-lifecycle.html">Data Lifecycle</a><li data-name="Storage"><a href="storage.html">Storage</a><li data-name="Migrations"><a href="migrations.html" class="white strong">Migrations</a><li data-name="Libraries"><a href="libraries.html">Libraries</a><li data-name="Prototype Inheritance Tree"><a href="prototype-tree.html">Prototype Inheritance Tree</a><li data-name="Noise Expressions"><a href="noise-expressions.html">Noise Expressions</a><li data-name="Instrument Mode"><a href="instrument.html">Instrument Mode</a><li data-name="Item Weight"><a href="item-weight.html">Item Weight</a></ul><h2 class="ml8 mt8 mb0 yellow">JSON Docs</h2><ul class="panel-hole" id="list-json"><li data-name="Runtime JSON Format"><a href="json-docs-runtime.html">Runtime JSON Format</a><li data-name="Prototype JSON Format"><a href="json-docs-prototype.html">Prototype JSON Format</a></ul><p><h2 class="ml8 mt8 mb0 yellow"><a class="collapse-link not-selectable" data-view="list-defines" data-collapsed="false"><img src="../static/collapse-symbol.png" class="collapse-icon" style="pointer-events: none;"><img src="../static/expand-symbol.png" class="expand-icon" style="pointer-events: none; display: none;"></a><a href="../defines.html"> Defines</a></h2><ul class="panel-hole" id="list-defines"><li data-name="alert_type"><a href="../defines.html#defines.alert_type">alert_type</a><li data-name="behavior_result"><a href="../defines.html#defines.behavior_result">behavior_result</a><li data-name="build_check_type"><a href="../defines.html#defines.build_check_type">build_check_type</a><li data-name="build_mode"><a href="../defines.html#defines.build_mode">build_mode</a><li data-name="cargo_destination"><a href="../defines.html#defines.cargo_destination">cargo_destination</a><li data-name="chain_signal_state"><a href="../defines.html#defines.chain_signal_state">chain_signal_state</a><li data-name="chunk_generated_status"><a href="../defines.html#defines.chunk_generated_status">chunk_generated_status</a><li data-name="command"><a href="../defines.html#defines.command">command</a><li data-name="compound_command"><a href="../defines.html#defines.compound_command">compound_command</a><li data-name="control_behavior"><a href="../defines.html#defines.control_behavior">control_behavior</a><li data-name="controllers"><a href="../defines.html#defines.controllers">controllers</a><li data-name="deconstruction_item"><a href="../defines.html#defines.deconstruction_item">deconstruction_item</a><li data-name="default_icon_size"><a href="../defines.html#defines.default_icon_size">default_icon_size</a><li data-name="difficulty"><a href="../defines.html#defines.difficulty">difficulty</a><li data-name="direction"><a href="../defines.html#defines.direction">direction</a><li data-name="disconnect_reason"><a href="../defines.html#defines.disconnect_reason">disconnect_reason</a><li data-name="distraction"><a href="../defines.html#defines.distraction">distraction</a><li data-name="entity_status"><a href="../defines.html#defines.entity_status">entity_status</a><li data-name="entity_status_diode"><a href="../defines.html#defines.entity_status_diode">entity_status_diode</a><li data-name="events"><a href="../defines.html#defines.events">events</a><li data-name="flow_precision_index"><a href="../defines.html#defines.flow_precision_index">flow_precision_index</a><li data-name="game_controller_interaction"><a href="../defines.html#defines.game_controller_interaction">game_controller_interaction</a><li data-name="group_state"><a href="../defines.html#defines.group_state">group_state</a><li data-name="gui_type"><a href="../defines.html#defines.gui_type">gui_type</a><li data-name="input_action"><a href="../defines.html#defines.input_action">input_action</a><li data-name="input_method"><a href="../defines.html#defines.input_method">input_method</a><li data-name="inventory"><a href="../defines.html#defines.inventory">inventory</a><li data-name="logistic_member_index"><a href="../defines.html#defines.logistic_member_index">logistic_member_index</a><li data-name="logistic_mode"><a href="../defines.html#defines.logistic_mode">logistic_mode</a><li data-name="logistic_section_type"><a href="../defines.html#defines.logistic_section_type">logistic_section_type</a><li data-name="mouse_button_type"><a href="../defines.html#defines.mouse_button_type">mouse_button_type</a><li data-name="moving_state"><a href="../defines.html#defines.moving_state">moving_state</a><li data-name="print_skip"><a href="../defines.html#defines.print_skip">print_skip</a><li data-name="print_sound"><a href="../defines.html#defines.print_sound">print_sound</a><li data-name="prototypes"><a href="../defines.html#defines.prototypes">prototypes</a><li data-name="rail_connection_direction"><a href="../defines.html#defines.rail_connection_direction">rail_connection_direction</a><li data-name="rail_direction"><a href="../defines.html#defines.rail_direction">rail_direction</a><li data-name="rail_layer"><a href="../defines.html#defines.rail_layer">rail_layer</a><li data-name="relative_gui_position"><a href="../defines.html#defines.relative_gui_position">relative_gui_position</a><li data-name="relative_gui_type"><a href="../defines.html#defines.relative_gui_type">relative_gui_type</a><li data-name="render_mode"><a href="../defines.html#defines.render_mode">render_mode</a><li data-name="rich_text_setting"><a href="../defines.html#defines.rich_text_setting">rich_text_setting</a><li data-name="riding"><a href="../defines.html#defines.riding">riding</a><li data-name="robot_order_type"><a href="../defines.html#defines.robot_order_type">robot_order_type</a><li data-name="rocket_silo_status"><a href="../defines.html#defines.rocket_silo_status">rocket_silo_status</a><li data-name="selection_mode"><a href="../defines.html#defines.selection_mode">selection_mode</a><li data-name="shooting"><a href="../defines.html#defines.shooting">shooting</a><li data-name="signal_state"><a href="../defines.html#defines.signal_state">signal_state</a><li data-name="space_platform_state"><a href="../defines.html#defines.space_platform_state">space_platform_state</a><li data-name="target_type"><a href="../defines.html#defines.target_type">target_type</a><li data-name="train_state"><a href="../defines.html#defines.train_state">train_state</a><li data-name="transport_line"><a href="../defines.html#defines.transport_line">transport_line</a><li data-name="wire_connector_id"><a href="../defines.html#defines.wire_connector_id">wire_connector_id</a><li data-name="wire_origin"><a href="../defines.html#defines.wire_origin">wire_origin</a><li data-name="wire_type"><a href="../defines.html#defines.wire_type">wire_type</a></ul></div></div><div class="docs-sidebar-thin mr8 flex-column" style="margin-top: 20px;"><a id="show-sidebar-button" class="button square-sm ml0">&gt;|</a></div></div></div></div></div><div class="footer"><div class="panel"><div class="panel-inset m0 text-center"> Copyright © Wube Software <span class="separator">|</span><a href="../license.html">License</a><span class="separator">|</span><a href="../static/archive.zip">Download</a><span class="separator">|</span><a href="https://forums.factorio.com/viewforum.php?f=233" target="_blank">Feedback</a></div></div></div></body></html>